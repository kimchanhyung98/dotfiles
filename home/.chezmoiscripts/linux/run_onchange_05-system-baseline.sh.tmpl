#!/bin/bash
#
# System baseline: default editor, paths, basic security
# Re-applies when this script changes

{{ if ne .chezmoi.os "linux" }}
exit 0
{{ end }}

set -eufo pipefail

echo "=== System Baseline ==="

# Default editor
if command -v vim &>/dev/null; then
    if ! grep -q 'EDITOR="vim"' "$HOME/.profile" 2>/dev/null; then
        echo "Setting vim as default editor..."
        echo 'export EDITOR="vim"' >> "$HOME/.profile"
        echo 'export VISUAL="vim"' >> "$HOME/.profile"
    fi
fi

# Ensure ~/.local/bin in PATH
mkdir -p "$HOME/.local/bin"
if ! grep -q '\.local/bin' "$HOME/.profile" 2>/dev/null; then
    echo 'export PATH="$HOME/.local/bin:$PATH"' >> "$HOME/.profile"
fi

echo "=== System Baseline complete ==="
