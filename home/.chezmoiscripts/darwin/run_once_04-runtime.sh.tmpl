#!/bin/bash
#
# Runtime: Bun (JavaScript/TypeScript)
# Runs once on first setup

{{ if ne .chezmoi.os "darwin" }}
exit 0
{{ end }}

set -eufo pipefail

echo "=== Runtime ==="

# Bun (download-then-execute for supply chain safety)
if ! command -v bun &>/dev/null; then
    echo "Installing Bun..."
    installer=$(mktemp)
    if curl -fsSL https://bun.sh/install -o "$installer"; then
        bash "$installer" || echo "Warning: Bun installation failed"
        rm -f "$installer"
    else
        rm -f "$installer"
        echo "Warning: Bun download failed"
    fi
else
    echo "Bun: already installed ($(bun --version))"
fi

echo "=== Runtime complete ==="
