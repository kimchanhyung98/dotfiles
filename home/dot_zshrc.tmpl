# ~/.zshrc
# Managed by chezmoi

# Homebrew (base)
{{ if eq .chezmoi.os "darwin" }}
{{ if .isAppleSilicon }}
eval "$(/opt/homebrew/bin/brew shellenv)"
{{ else }}
eval "$(/usr/local/bin/brew shellenv)"
{{ end }}
{{ end }}

# Path
export PATH="$HOME/.local/bin:$PATH"

{{ if eq .chezmoi.os "darwin" }}
# zerobrew: faster package manager, fallback to Homebrew
if command -v zb &>/dev/null; then
    pkg_install() { zb install "$@" || \brew install "$@"; }
fi
{{ end }}

# Oh My Zsh
export ZSH="$HOME/.oh-my-zsh"
ZSH_THEME="robbyrussell"
plugins=(
    git
    zsh-autosuggestions
    zsh-syntax-highlighting
)
[ -f "$ZSH/oh-my-zsh.sh" ] && source "$ZSH/oh-my-zsh.sh"

# History
HISTFILE=~/.zsh_history
HISTSIZE=10000
SAVEHIST=10000
setopt SHARE_HISTORY
setopt HIST_IGNORE_DUPS
setopt HIST_IGNORE_SPACE

# Key bindings
bindkey -e
bindkey '^[[A' history-search-backward
bindkey '^[[B' history-search-forward

# Aliases
alias ll='ls -la'
alias la='ls -A'
alias l='ls -CF'

# Git aliases
alias gs='git status'
alias ga='git add'
alias gc='git commit'
alias gp='git push'
alias gl='git pull'
alias gd='git diff'
alias gco='git checkout'
alias gb='git branch'

# Editor
export EDITOR="vim"
export VISUAL="vim"

# direnv
if command -v direnv &>/dev/null; then
    eval "$(direnv hook zsh)"
fi

# fzf
if command -v fzf &>/dev/null; then
    source <(fzf --zsh) 2>/dev/null || true
fi

# Bun
if [ -d "$HOME/.bun" ]; then
    export BUN_INSTALL="$HOME/.bun"
    export PATH="$BUN_INSTALL/bin:$PATH"
fi
